<pre>
  OEP: 11
  Title: dAPI for Mobile
  Author: josh chow <josh_chow@163.com>, dashuang wang <wdashuang@gmail.com>
  Type: Standard
  Status: Accepted
  Created: 2018-12-8
</pre>

==Abstract==
The OEP-11 Proposal is a standard interface like dAPI in Mobile. Support dApp wake up Provider and Provider scan QR code.

==Motivation==
dAPI currently only supports chrome extension, which cannot be used on the mobile side, Unable to meet a large number of mobile DAPP.

==Specification==
=== Mobile API ===

API for App wake up and QR code scan in Mobile

====sigdata====
<pre>
{
    "id":"t",
    "method":"sigdata",
    "appName":"",
    "params":{
        "rawData":"48656C6C6F20776F726C64" //Hello world
    }
}
</pre>

response:

</pre>
{
    "id": "1",
    "method": "sigdata",
    "errorcode": 0,
    "desc":"SUCCESS",
    "result": {
        "signedData": "cab96ef92419df915902817b2c9ed3f6c1c4956b3115737f7c787b03eed3f49e56547f3117867db64217b84cd6c6541d7b248f23ceeef3266a9a0bd6497260cb"
    }
 }
</pre>


====invoke smart contract====
<pre>
{
  "id": "sdggsg",
  "method": "invokesmartcontract",
  "appName":"",
  "params": {
    "contranHash":"",
    "operation": "testListAndStr",
    "args": [
      {
        "name": "msgList",
        "value": [
          true,
          100,
          "ByteArray:aabb",
          "String:hello",
          [
            true,
            100,
            "ByteArray:aabb",
            "String:hello"
          ]
        ]
      },
      {
        "name": "msgMap",
        "value": {
          "key": {
            "key": "String:hello2",
            "key1": true,
            "key3": 100
          }
        }
      },
      {
        "name": "msgStr",
        "value": "String:test"
      }
    ],
    "signature": {
      "m": 1,
      "signers": [
        "AUr5QUfeBADq6BMY6Tp5yuMsUNGpsD7nLZ"
      ]
    }
  }
}
</pre>


response:

</pre>
{
    "id": "1",
    "method": "invokesmartcontract",
    "errorcode": 0,
    "desc":"SUCCESS",
    "result": {
        "txHash": ""
    }
 }
</pre>

====transfer====
<pre>
{
    "id":"t",
    "method":"transfer",
    "appName":"",
    "params":{
    	"gas_price":0,
    	"gas_limit":20000,
    	"asset":"ont",
    	"from":"ATACcJPZ8eECdWS4ashaMdqzhywpRTq3oN",
    	"to":"AeoBhZtS8AmGp3Zt4LxvCqhdU4eSGiK44M",
    	"amount":"10"
    }
}
</pre>


response:


</pre>
{
    "id": "1",
    "method": "transfer",
    "errorcode": 0,
    "desc":"SUCCESS",
    "result": {
        "txHash": ""
    }
 }
</pre>









===Server API===


====post scan request====
<pre>
{
    "id":"t",
    "method":"postScanRequest",
    "params":{
        "data": "",
    }
}
</pre>


| Parameter   | Type  | description |          instruction |
| ------- | ------ | ------------- | ----------- |
| id  | String |           | Required |
| appName  | String |           | Required |
| data  | String |           | Required |
| time  | String |           | Required |


====post Signed====
<pre>
{
    "id":"t",
    "method":"postSigned",
    "params":{
        "appName":"vgame"
        "signedData": "cab96ef92419df915902817b2c9ed3f6c1c4956b3115737f7c787b03eed3f49e56547f3117867db64217b84cd6c6541d7b248f23ceeef3266a9a0bd6497260cb",
        "address":"AUr5QUfeBADq6BMY6Tp5yuMsUNGpsD7nLZ",
        "time": "20181204141130"
        "publickey":""
    }
}
</pre>


| Parameter   | Type  | description |          instruction |
| ------- | ------ | ------------- | ----------- |
| id  | String |           | Required |
| appName  | String |           | Required |
| signedData  | String |           | Required |
| address  | String |           | Required |
| publickey  | String |           | Required |
| time  | String |           | Required |

====post Invoke smartcontract Tx====

<pre>
{
    "id":"t",
    "method":"postInvokeSmartcontractTx",
    "params":{
        "appName":"vgame"
        "params": "",
        "address":"AUr5QUfeBADq6BMY6Tp5yuMsUNGpsD7nLZ",
        "time": "20181204141130"
    }
}
</pre>


| Parameter   | Type  | description |          instruction |
| ------- | ------ | ------------- | ----------- |
| id  | String |           | Required |
| appName  | String |           | Required |
| params  | String |           | Required |
| address  | String |           | Required |
| time  | String |           | Required |

====post Transfer Tx====

<pre>
{
    "id":"t",
    "method":"postTransferTx",
    "params":{
        "appName":"vgame"
        "params": "",
        "address":"AUr5QUfeBADq6BMY6Tp5yuMsUNGpsD7nLZ",
        "time": "20181204141130"
    }
}
</pre>


| Parameter   | Type  | description |          instruction |
| ------- | ------ | ------------- | ----------- |
| id  | String |           | Required |
| appName  | String |           | Required |
| params  | String |           | Required |
| address  | String |           | Required |
| time  | String |           | Required |

====query Sign====
<pre>
{
    "id":"t",
    "method":"querySign",
    "params":{
        "id": "id" //Hello world
    }
}
</pre>

response:

</pre>
{
    "id": "1",
    "method": "queryLogin",
    "errorcode": 0,
    "desc":"SUCCESS",
    "result": {
        "signedData": "cab96ef92419df915902817b2c9ed3f6c1c4956b3115737f7c787b03eed3f49e56547f3117867db64217b84cd6c6541d7b248f23ceeef3266a9a0bd6497260cb",
        "address":"AUr5QUfeBADq6BMY6Tp5yuMsUNGpsD7nLZ",
        "time": "20181204141130"
        "publickey":""

    }
 }
</pre>

====query transfer history====


http://127.0.0.1:80/api/v1/transfer/history/{pagesize}/{page}

response:

</pre>
{
    "id": "1",
    "method": "queryTransferHistory",
    "errorcode": 0,
    "desc":"SUCCESS",
    "result": {
        [
            {
                "id": "",
                "data": "",
                "state": "sended",   // or not send
                "time": "20181204141130"
                "hash": ""
             }
        ]

    }
 }
</pre>



====query  smartcontract invoke history====


http://127.0.0.1:80/api/v1/invokesmartcontract/history/{pagesize}/{page}

response:

</pre>
{
    "id": "1",
    "method": "queryTransferHistory",
    "errorcode": 0,
    "desc":"SUCCESS",
    "result": {
        [
            {
                "id": "",
                "data": "",
                "state": "sended",   // or not send
                "time": "20181204141130"
                "hash": ""
             }
        ]

    }
 }
</pre>


===Error code===



| Code   |  description |
| ------- | ------ |
| 0  | SUCCESS |
| 80001  | params error |
| 80002  | method error |
| 80003  | internal error |

==Implementation==
====Example implementations are available at====


